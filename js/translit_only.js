var l_A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#'";var r_A="ÀÁÖÄÅÔÃÕÈÉÊËÌÍÎÏßÐÑÒÓÂÙÕÛÇàáöäåôãõèéêëìíîïÿðñòóâùõûçúü";var kodirovka=0;var CD=false;var opera=((document.all)&&(document.getSelection))?1:0; var MB="";function onescapebutton(ev){if(ev.keyCode==27){onswitchkod();if(n6)ev.preventDefault();else ev.returnValue=false;}else{if(sbros){var Po=form['Post'];MB=Po.value;sbros=false;return true;}}return true;}
function onswitchkod(){var cHk=document.getElementById("EnableTranslit");cHk.checked=!cHk.checked;kodirovka=!kodirovka;deleteCookie("translit");setCookie("translit",kodirovka);var Po=form["Post"];Po.selectionStart=selStart;Po.selectionEnd=selEnd;Po.focus();}
function encodeCharacter(ev){if(!kodirovka||ev.ctrlKey)return;cd=(ie)?ev.keyCode:ev.charCode;lC=String.fromCharCode(cd);Po=form['Post'];if(ie){sT=document.selection.createRange();tc=sT.duplicate();sT.text="";sT.moveStart("character",-1);bC=sT.text;if(!bC){bC="";tc.select();}else{bC=bC.charAt(0);sT.select();}rC=tC(bC,lC);if(!CD){tc.select();return;}if(rC.length>1){rC=rC.charAt(1);sT.moveStart("character",1);sT.select();}ev.keyCode=rC.charCodeAt(0);}else if(n6){if(cd&&(!(ev.ctrlKey||ev.altKey))){pos=Po.selectionStart;if(pos>0){bC=Po.value[pos-1];}else{bC='';}rC=tC(bC,lC);if(!CD){return;}if(rC.length==2){rC=rC.charAt(1);}else{Po.selectionStart=pos-1;}ev.initKeyEvent(ev.type,ev.canBubble,ev.cancelable,ev.view,ev.ctrlKey,ev.altKey,ev.shiftKey,ev.metaKey,rC,rC.charCodeAt(0));}}return true;}function getKey(k1,k2){key2=k2.toLowerCase();BG=(k1==(key1=k1.toLowerCase()))?false:true;ret="";switch(key1){case'ü':{return key2=='\''?'Ü':'0';}break;case'ú':{return key2=='#'?'Ü':'0';}break;case'û':{switch(key2){case'o':{return mB(BG,'¸');}case'a':{return mB(BG,'ÿ');}case'u':{return mB(BG,'þ');}default:return'0';}}break;case'é':{switch(key2){case'o':{return mB(BG,'¸');}case'a':{return mB(BG,'ÿ');}case'u':{return mB(BG,'þ');}case'e':{return mB(BG,'ý');}default:return'0';}}break;case'ç':{return key2=='h'?mB(BG,'æ'):'0';}break;case'ñ':{return key2=='h'?mB(BG,'ø'):'0';}break;case'ø':{return key2=='h'?mB(BG,'ù'):'0';}break;case'ö':{return key2=='h'?mB(BG,'÷'):'0';}break;case'õ':{return key2=='h'?mB(BG,'ù'):'0';}break;case'è':{return key2=='\''?mB(BG,'é'):'0';}}return'0';}
function mB(x,ch){return x?ch.toUpperCase():ch;}
function tC(pC,cC){CD=true;key=getKey(pC,cC);if(key!='0'){return key;}iK=cC.charCodeAt(0)-'a'.charCodeAt(0);if(26>iK&&iK>-1){return pC+r_A.charAt(iK+26);}else{iG=cC.charCodeAt(0)-'A'.charCodeAt(0);if(26>iG&&iG>-1){return pC+r_A.charAt(iG);}else{if('\''==cC){return pC+'ü';}else{if('#'==cC){return pC+'ú';}}}}CD=false;return pC+cC;}
function storeBuffer(){Po=form['Post'];NB=Po.value;}var bE=0;var sbros=false;var was=false;function doTranslit(e){sbros=true;if(!kodirovka||e.keyCode==27)return;if(ie||n6)return;if(!e.ctrlKey&&was){was=false; return}if(e.ctrlKey){was=true;return}else{was=false;};fD(e);}
function tWt(txt){Mys="";len=txt.length;if(len==0)return txt;Mys+=tC('',txt.charAt(0));if(len==1){return Mys;}for(var i=1;i<len;i++){if(!bE){var rC=tC(Mys.charAt(Mys.length-1),txt.charAt(i));if(rC.length==2){Mys+=rC.charAt(1);}else{Mys=Mys.substring(0,Mys.length-1)+rC;}}else{Mys+=txt.charAt(i);}}bE=false;return Mys;}
function fD(ev){var Po=form['Post'];NB=Po.value;var minlength=NB.length<MB.length?NB.length:MB.length;var diff=Math.abs(NB.length-MB.length);if(MB.length==0){Po.value=tWt(NB);return;}var an=mid=end="";for(var i=0;i<minlength;i++){if(NB.charAt(i)!=MB.charAt(i)){an=MB.substr(0,i-1);mid=tWt(NB.substr(i-1,minlength==NB.length?diff:diff+1));end=NB.substr(i+diff,NB.length-(i+diff));Po.value=an+mid+end;return;}}mit=tC(NB.charAt(minlength-1),NB.charAt(minlength));if(mit.length==2){var rest=NB.charAt(minlength-1)+tWt(NB.substr(minlength,NB.length-(minlength)));if(!CD)return;Po.value=Po.value.substr(0,minlength-1)+rest;}else{if(mit.length==1){var rest=tWt(mit+NB.substr(minlength,NB.length-(minlength+1)));Po.value=Po.value.substr(0,minlength-1)+mit;}}}
